{"version":3,"sources":["services/OtpService.js","components/users/EditProfile.js"],"names":["OtpService","sendOtp","mobile","a","axios","post","res","data","swal","response","verifyOtp","EditProfile","container","useRef","useState","loading","setLoading","email","username","password","verified","user","setUser","otpSent","setOtpSent","otp","mobileVerify","setMobileVerify","history","useHistory","handleChange","e","name","target","value","handleChangeMobile","handleSubmit","preventDefault","AuthService","edit","push","handleSendOtp","message","handleVerifyOtp","useEffect","profile","prev","lottie","loadAnimation","current","render","loop","autoplay","animationData","require","fetchUser","className","role","ref","onSubmit","htmlFor","id","type","onChange","placeholder","onClick","class"],"mappings":"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","file":"static/js/16.5187c1a6.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport swal from \"sweetalert\";\r\n\r\nconst sendOtpUrl = \"/api/send-otp\";\r\nconst verifyOtpUrl = \"/api/verify-otp\";\r\n\r\nconst OtpService = {\r\n  sendOtp: async (mobile) => {\r\n    try {\r\n      const res = await axios.post(sendOtpUrl, mobile);\r\n      return res.data;\r\n    } catch (err) {\r\n      swal(\"Oops!\", err.response.data, \"error\");\r\n    }\r\n  },\r\n  verifyOtp: async (data) => {\r\n    try {\r\n      const res = await axios.post(verifyOtpUrl, { data });\r\n      return res.data;\r\n    } catch (err) {\r\n      swal(\"Oops!\", err.response.data, \"error\");\r\n    }\r\n  },\r\n};\r\n\r\nexport default OtpService;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport swal from \"sweetalert\";\r\nimport lottie from \"lottie-web\";\r\n\r\nimport AuthService from \"../../services/AuthService\";\r\nimport OtpService from \"../../services/OtpService\";\r\n\r\nexport default function EditProfile() {\r\n  const container = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [user, setUser] = useState({\r\n    email: \"\",\r\n    username: \"\",\r\n    password: \"\",\r\n    mobile: \"\",\r\n    verified: false,\r\n  });\r\n\r\n  const [otpSent, setOtpSent] = useState(false);\r\n\r\n  const [mobileVerify, setMobileVerify] = useState({\r\n    mobile: \"\",\r\n    otp: \"\",\r\n  });\r\n\r\n  const history = useHistory();\r\n\r\n  const handleChange = (e) => {\r\n    const name = e.target.name;\r\n    const value = e.target.value;\r\n    setUser({ ...user, [name]: value });\r\n  };\r\n\r\n  const handleChangeMobile = (e) => {\r\n    const name = e.target.name;\r\n    const value = e.target.value;\r\n    setMobileVerify({ ...mobileVerify, [name]: value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    await AuthService.edit(user);\r\n    history.push(\"/profile\");\r\n  };\r\n\r\n  const handleSendOtp = async () => {\r\n    const res = await OtpService.sendOtp();\r\n    if (res.message) {\r\n      setOtpSent(true);\r\n    }\r\n  };\r\n\r\n  const handleVerifyOtp = async (e) => {\r\n    e.preventDefault();\r\n    const res = await OtpService.verifyOtp(mobileVerify);\r\n    if (res.message) {\r\n      await swal(\"Verified\", \"Mobile verification successfull\", \"success\");\r\n    }\r\n    history.push(\"/profile\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function fetchUser() {\r\n      const res = await AuthService.profile();\r\n      setUser(res);\r\n      setMobileVerify((prev) => {\r\n        return { ...prev, mobile: res.mobile };\r\n      });\r\n      setLoading((loading) => !loading);\r\n      lottie.loadAnimation({\r\n        container: container.current,\r\n        render: \"svg\",\r\n        loop: true,\r\n        autoplay: true,\r\n        animationData: require(\"../../lottie/edit-profile.json\"),\r\n      });\r\n    }\r\n    fetchUser();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"d-flex justify-content-center mt-5\">\r\n        <div className=\"spinner-border\" role=\"status\">\r\n          <span className=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <div className=\"container\">\r\n          <div className=\"row pt-5\">\r\n            <div className=\"col-md-6 mx-auto\">\r\n              <div ref={container}></div>\r\n            </div>\r\n            <div className=\"col-md-6 mx-auto\">\r\n              <div className=\"col-md-12 mt-3\">\r\n                <div className=\"card rounded-0\">\r\n                  <div className=\"card-header\">\r\n                    <h3 className=\"mb-0 \">Edit Profile</h3>\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    <form className=\"form\" onSubmit={handleSubmit}>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"email\">New Email</label>\r\n                        <input\r\n                          id=\"email\"\r\n                          name=\"email\"\r\n                          type=\"email\"\r\n                          className=\"form-control rounded-0\"\r\n                          value={user.email || \"\"}\r\n                          onChange={handleChange}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"username\">New Username</label>\r\n                        <input\r\n                          id=\"username\"\r\n                          name=\"username\"\r\n                          type=\"text\"\r\n                          className=\"form-control rounded-0\"\r\n                          value={user.username || \"\"}\r\n                          onChange={handleChange}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"password\">\r\n                          Password or New Password If you want to change.\r\n                        </label>\r\n                        <input\r\n                          id=\"password\"\r\n                          name=\"password\"\r\n                          type=\"password\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter password\"\r\n                          value={user.password || \"\"}\r\n                          onChange={handleChange}\r\n                        />\r\n                      </div>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-success float-right\"\r\n                      >\r\n                        Update Profile\r\n                      </button>\r\n                    </form>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"col-md-12 mt-3 mb-5\">\r\n                <div className=\"card rounded-0\">\r\n                  <div className=\"card-header\">\r\n                    <h3 className=\"mb-0 \">Profile Verification</h3>\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    <form className=\"form\" onSubmit={handleVerifyOtp}>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"mobile\">Mobile Number</label>\r\n                        <input\r\n                          id=\"mobile\"\r\n                          name=\"mobile\"\r\n                          type=\"tel\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter your mobile number\"\r\n                          value={mobileVerify.mobile || \"\"}\r\n                          onChange={handleChangeMobile}\r\n                        />\r\n                      </div>\r\n                      <div className=\"container text-center\">\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"btn btn-success btn-sm\"\r\n                          onClick={handleSendOtp}\r\n                        >\r\n                          Send OTP\r\n                        </button>\r\n                      </div>\r\n                      {otpSent && (\r\n                        <div class=\"alert alert-success mt-2\">\r\n                          Otp hass been sent to your mobile number.\r\n                        </div>\r\n                      )}\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"otp\">OTP</label>\r\n                        <input\r\n                          id=\"otp\"\r\n                          type=\"text\"\r\n                          name=\"otp\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter otp\"\r\n                          value={mobileVerify.otp || \"\"}\r\n                          onChange={handleChangeMobile}\r\n                        />\r\n                      </div>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-success float-right\"\r\n                      >\r\n                        Verify\r\n                      </button>\r\n                    </form>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}