{"version":3,"sources":["services/OtpService.js","components/users/EditProfile.js","helpers/Validators.js"],"names":["OtpService","sendOtp","mobile","a","axios","post","res","data","swal","response","verifyOtp","EditProfile","container","useRef","useState","loading","setLoading","useForm","resolver","yupResolver","editSchema","register","handleSubmit","errors","formState","setValue","mobileSchema","mode","register2","handleSubmit2","errors2","setValue2","getValues","otpSent","setOtpSent","mobileError","setMobileError","history","useHistory","onSubmit","AuthService","edit","push","handleSendOtp","message","handleVerifyOtp","useEffect","profile","email","shouldValidate","username","lottie","loadAnimation","current","render","loop","autoplay","animationData","require","fetchUser","className","role","ref","htmlFor","id","name","type","placeholder","password","class","onClick","otp","loginSchema","yup","shape","required","min","forgotSchema","registerSchema","confirmPassword","oneOf","resetSchema","matches"],"mappings":"6sxMAMMA,EAAa,CACjBC,QAAQ,WAAD,4BAAE,WAAOC,GAAP,eAAAC,EAAA,+EAEaC,IAAMC,KANX,gBAM4BH,GAFpC,cAECI,EAFD,yBAGEA,EAAIC,MAHN,gCAKLC,IAAK,QAAS,KAAIC,SAASF,KAAM,SAL5B,yDAAF,mDAAC,GAQRG,UAAU,WAAD,4BAAE,WAAOH,GAAP,eAAAJ,EAAA,+EAEWC,IAAMC,KAbT,kBAa4B,CAAEE,SAFtC,cAEDD,EAFC,yBAGAA,EAAIC,MAHJ,gCAKPC,IAAK,QAAS,KAAIC,SAASF,KAAM,SAL1B,yDAAF,mDAAC,IAUGP,I,eCbA,SAASW,IACtB,IAAMC,EAAYC,iBAAO,MAEzB,EAA8BC,oBAAS,GAAvC,mBAAOC,EAAP,KAAgBC,EAAhB,KASA,EAKIC,YAAQ,CACVC,SAAUC,YAAYC,OALtBC,EADF,EACEA,SACAC,EAFF,EAEEA,aACaC,EAHf,EAGEC,UAAaD,OACbE,EAJF,EAIEA,SAKF,EAMIR,YAAQ,CACVC,SAAUC,YAAYO,KACtBC,KAAM,aAPIC,EADZ,EACEP,SACcQ,EAFhB,EAEEP,aACqBQ,EAHvB,EAGEN,UAAaD,OACHQ,EAJZ,EAIEN,SACAO,EALF,EAKEA,UAMF,EAA8BlB,oBAAS,GAAvC,mBAAOmB,EAAP,KAAgBC,EAAhB,KACA,EAAsCpB,oBAAS,GAA/C,mBAAOqB,EAAP,KAAoBC,EAApB,KAOMC,EAAUC,cAcVC,EAAQ,uCAAG,WAAOhC,GAAP,SAAAJ,EAAA,sEACTqC,IAAYC,KAAKlC,GADR,OAEf8B,EAAQK,KAAK,YAFE,2CAAH,sDAWRC,EAAa,uCAAG,sBAAAxC,EAAA,yDACf6B,EAAU,UADK,gBAElBI,GAAe,GACfF,GAAW,GAHO,sCAKAlC,EAAWC,UALX,cAMV2C,UACNV,GAAW,GACXE,GAAe,IARC,2CAAH,qDAabS,EAAe,uCAAG,WAAOtC,GAAP,SAAAJ,EAAA,sEAEJH,EAAWU,UAAUH,GAFjB,kBAGdqC,QAHc,gCAIdpC,IAAK,WAAY,kCAAmC,WAJtC,OAMtB6B,EAAQK,KAAK,YANS,2CAAH,sDAgCrB,OAvBAI,qBAAU,WAAM,4CACd,4BAAA3C,EAAA,sEACoBqC,IAAYO,UADhC,OACQzC,EADR,OAGEmB,EAAS,QAASnB,EAAI0C,MAAO,CAAEC,gBAAgB,IAC/CxB,EAAS,WAAYnB,EAAI4C,SAAU,CAAED,gBAAgB,IAKrDlB,EAAU,SAAUzB,EAAIJ,OAAQ,CAAE+C,gBAAgB,IAClDjC,GAAW,SAACD,GAAD,OAAcA,KACzBoC,IAAOC,cAAc,CACnBxC,UAAWA,EAAUyC,QACrBC,OAAQ,MACRC,MAAM,EACNC,UAAU,EACVC,cAAeC,EAAQ,OAhB3B,2CADc,yBAAC,WAAD,wBAoBdC,KACC,IAEC5C,EAEA,qBAAK6C,UAAU,qCAAf,SACE,qBAAKA,UAAU,iBAAiBC,KAAK,SAArC,SACE,sBAAMD,UAAU,kBAAhB,4BAMJ,mCACE,qBAAKA,UAAU,YAAf,SACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,mBAAf,SACE,qBAAKE,IAAKlD,MAEZ,sBAAKgD,UAAU,mBAAf,UACE,qBAAKA,UAAU,iBAAf,SACE,sBAAKA,UAAU,iBAAf,UACE,qBAAKA,UAAU,cAAf,SACE,oBAAIA,UAAU,QAAd,4BAEF,qBAAKA,UAAU,YAAf,SACE,uBAAMA,UAAU,OAAOrB,SAAUjB,EAAaiB,GAA9C,UACE,sBAAKqB,UAAU,aAAf,UACE,uBAAOG,QAAQ,QAAf,uBACA,mCACEC,GAAG,QACHC,KAAK,QACLL,UAAU,0BACNvC,EAAS,WAEdE,EAAOyB,OACN,qBAAKY,UAAU,0BAA0BC,KAAK,QAA9C,SACGtC,EAAOyB,MAAMJ,aAIpB,sBAAKgB,UAAU,aAAf,UACE,uBAAOG,QAAQ,WAAf,0BACA,mCACEC,GAAG,WACHC,KAAK,WACLL,UAAU,0BACNvC,EAAS,cAEdE,EAAO2B,UACN,qBAAKU,UAAU,0BAA0BC,KAAK,QAA9C,SACGtC,EAAO2B,SAASN,aAIvB,sBAAKgB,UAAU,aAAf,UACE,uBAAOG,QAAQ,WAAf,6DAGA,mCACEC,GAAG,WACHC,KAAK,WACLC,KAAK,WACLN,UAAU,yBACVO,YAAY,kBACR9C,EAAS,cAEdE,EAAO6C,UACN,qBAAKR,UAAU,0BAA0BC,KAAK,QAA9C,SACGtC,EAAO6C,SAASxB,aAIvB,wBACEsB,KAAK,SACLN,UAAU,8BAFZ,sCAUR,qBAAKA,UAAU,sBAAf,SACE,sBAAKA,UAAU,iBAAf,UACE,qBAAKA,UAAU,cAAf,SACE,oBAAIA,UAAU,QAAd,oCAEF,qBAAKA,UAAU,YAAf,SACE,uBACEA,UAAU,OACVrB,SAAUV,EAAcgB,GAF1B,UAIE,sBAAKe,UAAU,aAAf,UACE,uBAAOG,QAAQ,SAAf,2BACA,mCACEC,GAAG,SACHC,KAAK,SACLL,UAAU,yBACVO,YAAY,4BACRvC,EAAU,YAEfE,EAAQ5B,QACP,qBAAK0D,UAAU,0BAA0BC,KAAK,QAA9C,SACG/B,EAAQ5B,OAAO0C,aAIrBT,GACC,qBAAKkC,MAAM,0BAAX,wCAIF,qBAAKT,UAAU,wBAAf,SACE,wBACEM,KAAK,SACLN,UAAU,yBACVU,QAAS3B,EAHX,wBAQDV,GACC,qBAAKoC,MAAM,2BAAX,uDAKF,sBAAKT,UAAU,aAAf,UACE,uBAAOG,QAAQ,MAAf,iBACA,mCACEC,GAAG,MACHC,KAAK,MACLL,UAAU,yBACVO,YAAY,aACRvC,EAAU,SAEfE,EAAQyC,KACP,qBAAKX,UAAU,0BAA0BC,KAAK,QAA9C,SACG/B,EAAQyC,IAAI3B,aAInB,wBACEsB,KAAK,SACLN,UAAU,8BAFZ,0C,gCCtQtB,wNAKMY,EAAcC,MAAaC,MAAM,CACrC1B,MAAOyB,MAAazB,MAAM,yBAAyB2B,SAAS,aAC5DP,SAAUK,MAEPE,SAAS,aACTC,IAAI,EAAG,0CAGNC,EAAeJ,MAAaC,MAAM,CACtC1B,MAAOyB,MAAazB,MAAM,yBAAyB2B,SAAS,eAGxDG,EAAiBL,MAAaC,MAAM,CACxC1B,MAAOyB,MAAazB,MAAM,yBAAyB2B,SAAS,aAC5DzB,SAAUuB,MAEPE,SAAS,aACTC,IAAI,EAAG,wCACVR,SAAUK,MAEPE,SAAS,aACTC,IAAI,EAAG,wCACVG,gBAAiBN,MAEdE,SAAS,aACTK,MAAM,CAACP,IAAQ,YAAa,MAAO,0BAGlCQ,EAAcR,MAAaC,MAAM,CACrCN,SAAUK,MAEPE,SAAS,aACTC,IAAI,EAAG,wCACVG,gBAAiBN,MAEdE,SAAS,aACTK,MAAM,CAACP,IAAQ,YAAa,MAAO,0BAGlCrD,EAAaqD,MAAaC,MAAM,CACpC1B,MAAOyB,MAAazB,MAAM,yBAAyB2B,SAAS,aAC5DzB,SAAUuB,MAEPE,SAAS,aACTC,IAAI,EAAG,wCACVR,SAAUK,MAEPE,SAAS,aACTC,IAAI,EAAG,0CAGNlD,EAAe+C,MAAaC,MAAM,CACtCxE,OAAQuE,MAELE,SAAS,aACTO,QAzDH,8EAyDyB,4BACzBX,IAAKE,MAEFE,SAAS,aACTC,IAAI,EAAG","file":"static/js/11.d701cd62.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport swal from \"sweetalert\";\r\n\r\nconst sendOtpUrl = \"/api/send-otp\";\r\nconst verifyOtpUrl = \"/api/verify-otp\";\r\n\r\nconst OtpService = {\r\n  sendOtp: async (mobile) => {\r\n    try {\r\n      const res = await axios.post(sendOtpUrl, mobile);\r\n      return res.data;\r\n    } catch (err) {\r\n      swal(\"Oops!\", err.response.data, \"error\");\r\n    }\r\n  },\r\n  verifyOtp: async (data) => {\r\n    try {\r\n      const res = await axios.post(verifyOtpUrl, { data });\r\n      return res.data;\r\n    } catch (err) {\r\n      swal(\"Oops!\", err.response.data, \"error\");\r\n    }\r\n  },\r\n};\r\n\r\nexport default OtpService;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport swal from \"sweetalert\";\r\nimport lottie from \"lottie-web\";\r\n\r\nimport AuthService from \"../../services/AuthService\";\r\nimport OtpService from \"../../services/OtpService\";\r\n\r\nimport { editSchema, mobileSchema } from \"../../helpers/Validators\";\r\n\r\nexport default function EditProfile() {\r\n  const container = useRef(null);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  // const [user, setUser] = useState({\r\n  //   email: \"\",\r\n  //   username: \"\",\r\n  //   password: \"\",\r\n  //   mobile: \"\",\r\n  //   verified: false,\r\n  // });\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n    setValue,\r\n  } = useForm({\r\n    resolver: yupResolver(editSchema),\r\n  });\r\n\r\n  const {\r\n    register: register2,\r\n    handleSubmit: handleSubmit2,\r\n    formState: { errors: errors2 },\r\n    setValue: setValue2,\r\n    getValues,\r\n  } = useForm({\r\n    resolver: yupResolver(mobileSchema),\r\n    mode: \"onChange\",\r\n  });\r\n\r\n  const [otpSent, setOtpSent] = useState(false);\r\n  const [mobileError, setMobileError] = useState(false);\r\n\r\n  // const [mobileVerify, setMobileVerify] = useState({\r\n  //   mobile: \"\",\r\n  //   otp: \"\",\r\n  // });\r\n\r\n  const history = useHistory();\r\n\r\n  // const handleChange = (e) => {\r\n  //   const name = e.target.name;\r\n  //   const value = e.target.value;\r\n  //   setUser({ ...user, [name]: value });\r\n  // };\r\n\r\n  // const handleChangeMobile = (e) => {\r\n  //   const name = e.target.name;\r\n  //   const value = e.target.value;\r\n  //   setMobileVerify({ ...mobileVerify, [name]: value });\r\n  // };\r\n\r\n  const onSubmit = async (data) => {\r\n    await AuthService.edit(data);\r\n    history.push(\"/profile\");\r\n  };\r\n\r\n  // const handleSubmit = async (e) => {\r\n  //   e.preventDefault();\r\n  //   await AuthService.edit(user);\r\n  //   history.push(\"/profile\");\r\n  // };\r\n\r\n  const handleSendOtp = async () => {\r\n    if (!getValues(\"mobile\")) {\r\n      setMobileError(true);\r\n      setOtpSent(false);\r\n    } else {\r\n      const res = await OtpService.sendOtp();\r\n      if (res.message) {\r\n        setOtpSent(true);\r\n        setMobileError(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleVerifyOtp = async (data) => {\r\n    // e.preventDefault();\r\n    const res = await OtpService.verifyOtp(data);\r\n    if (res.message) {\r\n      await swal(\"Verified\", \"Mobile verification successfull\", \"success\");\r\n    }\r\n    history.push(\"/profile\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function fetchUser() {\r\n      const res = await AuthService.profile();\r\n      // setUser(res);\r\n      setValue(\"email\", res.email, { shouldValidate: true });\r\n      setValue(\"username\", res.username, { shouldValidate: true });\r\n\r\n      // setMobileVerify((prev) => {\r\n      //   return { ...prev, mobile: res.mobile };\r\n      // });\r\n      setValue2(\"mobile\", res.mobile, { shouldValidate: true });\r\n      setLoading((loading) => !loading);\r\n      lottie.loadAnimation({\r\n        container: container.current,\r\n        render: \"svg\",\r\n        loop: true,\r\n        autoplay: true,\r\n        animationData: require(\"../../lottie/edit-profile.json\"),\r\n      });\r\n    }\r\n    fetchUser();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"d-flex justify-content-center mt-5\">\r\n        <div className=\"spinner-border\" role=\"status\">\r\n          <span className=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  } else {\r\n    return (\r\n      <>\r\n        <div className=\"container\">\r\n          <div className=\"row pt-5\">\r\n            <div className=\"col-md-6 mx-auto\">\r\n              <div ref={container}></div>\r\n            </div>\r\n            <div className=\"col-md-6 mx-auto\">\r\n              <div className=\"col-md-12 mt-3\">\r\n                <div className=\"card rounded-0\">\r\n                  <div className=\"card-header\">\r\n                    <h3 className=\"mb-0 \">Edit Profile</h3>\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    <form className=\"form\" onSubmit={handleSubmit(onSubmit)}>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"email\">New Email</label>\r\n                        <input\r\n                          id=\"email\"\r\n                          name=\"email\"\r\n                          className=\"form-control rounded-0\"\r\n                          {...register(\"email\")}\r\n                        />\r\n                        {errors.email && (\r\n                          <div className=\"alert alert-danger mt-2\" role=\"alert\">\r\n                            {errors.email.message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"username\">New Username</label>\r\n                        <input\r\n                          id=\"username\"\r\n                          name=\"username\"\r\n                          className=\"form-control rounded-0\"\r\n                          {...register(\"username\")}\r\n                        />\r\n                        {errors.username && (\r\n                          <div className=\"alert alert-danger mt-2\" role=\"alert\">\r\n                            {errors.username.message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"password\">\r\n                          Password or New Password If you want to change.\r\n                        </label>\r\n                        <input\r\n                          id=\"password\"\r\n                          name=\"password\"\r\n                          type=\"password\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter password\"\r\n                          {...register(\"password\")}\r\n                        />\r\n                        {errors.password && (\r\n                          <div className=\"alert alert-danger mt-2\" role=\"alert\">\r\n                            {errors.password.message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-success float-right\"\r\n                      >\r\n                        Update Profile\r\n                      </button>\r\n                    </form>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"col-md-12 mt-3 mb-5\">\r\n                <div className=\"card rounded-0\">\r\n                  <div className=\"card-header\">\r\n                    <h3 className=\"mb-0 \">Profile Verification</h3>\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    <form\r\n                      className=\"form\"\r\n                      onSubmit={handleSubmit2(handleVerifyOtp)}\r\n                    >\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"mobile\">Mobile Number</label>\r\n                        <input\r\n                          id=\"mobile\"\r\n                          name=\"mobile\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter your mobile number\"\r\n                          {...register2(\"mobile\")}\r\n                        />\r\n                        {errors2.mobile && (\r\n                          <div className=\"alert alert-danger mt-2\" role=\"alert\">\r\n                            {errors2.mobile.message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {mobileError && (\r\n                        <div class=\"alert alert-danger mt-2\">\r\n                          Enter mobile number first.\r\n                        </div>\r\n                      )}\r\n                      <div className=\"container text-center\">\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"btn btn-success btn-sm\"\r\n                          onClick={handleSendOtp}\r\n                        >\r\n                          Send OTP\r\n                        </button>\r\n                      </div>\r\n                      {otpSent && (\r\n                        <div class=\"alert alert-success mt-2\">\r\n                          Otp hass been sent to your mobile number.\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"form-group\">\r\n                        <label htmlFor=\"otp\">OTP</label>\r\n                        <input\r\n                          id=\"otp\"\r\n                          name=\"otp\"\r\n                          className=\"form-control rounded-0\"\r\n                          placeholder=\"Enter otp\"\r\n                          {...register2(\"otp\")}\r\n                        />\r\n                        {errors2.otp && (\r\n                          <div className=\"alert alert-danger mt-2\" role=\"alert\">\r\n                            {errors2.otp.message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-success float-right\"\r\n                      >\r\n                        Verify\r\n                      </button>\r\n                    </form>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n","import * as yup from \"yup\";\r\n\r\nconst mobileRegExp =\r\n  /^(?:(?:\\+|0{0,2})91(\\s*|[\\-])?|[0]?)?([6789]\\d{2}([ -]?)\\d{3}([ -]?)\\d{4})$/;\r\n\r\nconst loginSchema = yup.object().shape({\r\n  email: yup.string().email(\"Invalid email format.\").required(\"Required.\"),\r\n  password: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(6, \"Password should atleast 6 char long.\"),\r\n});\r\n\r\nconst forgotSchema = yup.object().shape({\r\n  email: yup.string().email(\"Invalid email format.\").required(\"Required.\"),\r\n});\r\n\r\nconst registerSchema = yup.object().shape({\r\n  email: yup.string().email(\"Invalid email format.\").required(\"Required.\"),\r\n  username: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(4, \"Username should atleast 4 char long.\"),\r\n  password: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(6, \"Password should atleast 6 char long.\"),\r\n  confirmPassword: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .oneOf([yup.ref(\"password\"), null], \"Passwords must match\"),\r\n});\r\n\r\nconst resetSchema = yup.object().shape({\r\n  password: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(6, \"Password should atleast 6 char long.\"),\r\n  confirmPassword: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .oneOf([yup.ref(\"password\"), null], \"Passwords must match\"),\r\n});\r\n\r\nconst editSchema = yup.object().shape({\r\n  email: yup.string().email(\"Invalid email format.\").required(\"Required.\"),\r\n  username: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(4, \"Username should atleast 4 char long.\"),\r\n  password: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(6, \"Password should atleast 6 char long.\"),\r\n});\r\n\r\nconst mobileSchema = yup.object().shape({\r\n  mobile: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .matches(mobileRegExp, \"Incorrect mobile format.\"),\r\n  otp: yup\r\n    .string()\r\n    .required(\"Required.\")\r\n    .min(5, \"Otp should atleast 5 char long.\"),\r\n});\r\n\r\nexport {\r\n  loginSchema,\r\n  forgotSchema,\r\n  registerSchema,\r\n  resetSchema,\r\n  editSchema,\r\n  mobileSchema,\r\n};\r\n"],"sourceRoot":""}